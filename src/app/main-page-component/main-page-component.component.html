<mat-card class="input-card">
    <mat-card-title>CUSTOMER INPUT:</mat-card-title>
    <form>
        <div class="horizontal-order">
            <mat-form-field class="email-input" appearance="fill">
                <mat-label>Email</mat-label>
                <input type="email" matInput placeholder="Ex. pat@example.com" [(ngModel)]="emailInput"
                    (ngModelChange)="modelChangeFn($event, 'email')" name="emailInputField" />
                <button *ngIf="emailInput" matSuffix mat-icon-button aria-label="Clear" (click)="emailInput=''">
                    <mat-icon>close</mat-icon>
                </button>
            </mat-form-field>
            <p class="middle-text">OR</p>
            <mat-form-field class="account-id-input" appearance="fill">
                <mat-label>NFM account</mat-label>
                <input matInput placeholder="Ex. 325898524" [(ngModel)]="accountInput"
                    (ngModelChange)="modelChangeFn($event, 'accountId')" name="accountInputField" />
                <button *ngIf="accountInput" matSuffix mat-icon-button aria-label="Clear" (click)="accountInput=''">
                    <mat-icon>close</mat-icon>
                </button>
            </mat-form-field>
        </div>
    </form>
    <p *ngIf="showErrorMessage" class="error-message">
        At least one input is required!
    </p>
    <mat-card-actions class="action-button">
        <button (click)="lookup_EVENT()" mat-raised-button color="primary">
            VIEW
        </button>
    </mat-card-actions>
</mat-card>

<mat-card class="input-card" *ngIf="showUserInfoSection">
    <div class="horizontal-order justify-center" *ngIf="loading">
        <mat-card-content class="text-center">
            <p>Loading</p>
            <mat-spinner [diameter]="30"></mat-spinner>
        </mat-card-content>
    </div>
    <form id="myForm" [formGroup]="thisIsMyForm">
        <div [formArrayName]="'formArrayName'">
            <mat-card *ngFor="let x of emails.customers; let i = index">
                <div [formGroupName]="i">
                    <mat-form-field class="account-id-input" appearance="fill">
                        <mat-label>First Name</mat-label>
                        <input formControlName="firstName" matInput placeholder="Ex. Anderson" [value]="x.firstName" />
                    </mat-form-field>
                    <button *ngIf="formControlState(i)" (click)="toggleEdit(i)">Enable Edit</button>
                    <button *ngIf="!formControlState(i)" (click)="toggleEdit(i)">Save</button>
                </div>
            </mat-card>
            <button (click)="update_EVENT()">Submit Form</button>
        </div>
    </form>
    <div *ngIf="!loading">
        <mat-card-title>CUSTOMER INFO DISPLAY:</mat-card-title>
        <mat-divider></mat-divider>
        <div class="vertical-order" *ngIf="searchType == 'email'">
            <mat-accordion>
                <mat-expansion-panel *ngFor="let e of emails; let i = index" (opened)="panelOpenState = true;"
                    (closed)="panelOpenState = false">
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            CUSTOMERID: {{ e.nfmAccountId }}
                        </mat-panel-title>
                        <mat-panel-description>
                            {{ e.pEmail }}
                        </mat-panel-description>
                    </mat-expansion-panel-header>
                    <div class="horizontal-order">
                        <form id="myForm" [formGroup]="thisIsMyForm">
                            <div [formArrayName]="'formArrayName'">
                                <div class="vertical-order" *ngFor="let customer of e.customers; let i = index"
                                    [formGroupName]="i">

                                    <mat-form-field class="account-id-input" appearance="fill">
                                        <mat-label>First Name</mat-label>
                                        <input formControlName="firstName" matInput placeholder="Ex. Anderson"
                                            [value]="customer.firstName" />
                                    </mat-form-field>
                                    <mat-form-field class="account-id-input" appearance="fill">
                                        <mat-label>Middle Name</mat-label>
                                        <input formControlName="middleName" matInput placeholder="Ex. Anderson"
                                            [value]="customer.middleName" />
                                    </mat-form-field>
                                    <mat-form-field class="account-id-input" appearance="fill">
                                        <mat-label>Last Name</mat-label>
                                        <input formControlName="lastName" matInput placeholder="Ex. Anderson"
                                            [value]="customer.lastName" />
                                    </mat-form-field>
                                    <mat-form-field class="account-id-input" appearance="fill">
                                        <mat-label>Address</mat-label>
                                        <input formControlName="addressLineOneText" matInput
                                            placeholder="Ex. 1234 Dodge St." [value]="customer.addressLineOneText" />
                                    </mat-form-field>
                                    <mat-form-field class="account-id-input" appearance="fill">
                                        <mat-label>Address 2</mat-label>
                                        <input formControlName="addressLineTwoText" matInput
                                            placeholder="Ex. 1234 Dodge St." [value]="customer.addressLineTwoText" />
                                    </mat-form-field>
                                    <mat-form-field class="account-id-input" appearance="fill">
                                        <mat-label>City</mat-label>
                                        <input formControlName="addressCityName" matInput placeholder="Ex. Omaha"
                                            [value]="customer.addressCityName" />
                                    </mat-form-field>
                                    <mat-form-field appearance="fill" class="account-id-input">
                                        <mat-label>State</mat-label>
                                        <mat-select formControlName="addressStateProvinceCode" [id]="'some' + i"
                                            [value]="customer.addressStateProvinceCode">
                                            <mat-option *ngFor="let state of allStates"
                                                [value]="customer.addressStateProvinceCode">
                                                {{ state }}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                    <mat-form-field class="account-id-input" appearance="fill">
                                        <mat-label>Zip Code</mat-label>
                                        <input formControlName="addressPostalPlusFourCode" matInput
                                            placeholder="Ex. 68102" [value]="customer.addressPostalPlusFourCode" />
                                    </mat-form-field>
                                    <mat-form-field class="account-id-input" appearance="fill">
                                        <mat-label>Country Code</mat-label>
                                        <input formControlName="addressCountryCode" matInput placeholder="Ex. 68102"
                                            [value]="customer.addressCountryCode" />
                                    </mat-form-field>
                                    <mat-form-field class="account-id-input" appearance="fill">
                                        <mat-label>Phone Work</mat-label>
                                        <input formControlName="phoneWork" matInput placeholder="Ex. 4025448231"
                                            [value]="customer.phoneWork" />
                                    </mat-form-field>
                                    <mat-form-field class="account-id-input" appearance="fill">
                                        <mat-label>Phone Home</mat-label>
                                        <input formControlName="phoneHome" matInput placeholder="Ex. 4025448231"
                                            [value]="customer.phoneHome" name="phoneInputField" />
                                    </mat-form-field>
                                    <!-- <mat-form-field class="account-id-input" appearance="fill">
                                <mat-label>Email ID:</mat-label>
                                <input formControlName="name" matInput placeholder="Ex. 68102" [value]="customer.pEmail | pEmailID"
                                    (ngModelChange)="updateEmailValue($event)" name="zipCodeInputField" />
                            </mat-form-field>
                            <mat-form-field class="account-id-input" appearance="fill">
                                <mat-label>Email String</mat-label>
                                <input formControlName="name" matInput placeholder="Ex. 68102" [value]="customer.pEmail | pEmailString"
                                    (ngModelChange)="updateEmailValue($event)" name="zipCodeInputField" />
                            </mat-form-field> -->
                                    <mat-form-field class="account-id-input" appearance="fill"
                                        [ngClass]="{'hidden': customer.accountPartyType == 'Primary'}">
                                        <mat-label>Email</mat-label>
                                        <input formControlName="pEmail" matInput placeholder="Ex. 68102"
                                            [value]="customer.pEmail | email"
                                            (ngModelChange)="updateEmailValue($event)" />
                                    </mat-form-field>
                                    <mat-form-field class="account-id-input" appearance="fill"
                                        [ngClass]="{'hidden': customer.accountPartyType == 'Joint'}">
                                        <mat-label>Email</mat-label>
                                        <input formControlName="jEmail" matInput placeholder="Ex. 68102"
                                            [value]="customer.jEmail | email"
                                            (ngModelChange)="updateEmailValue($event)" />
                                    </mat-form-field>
                                    <button *ngIf="formControlState(i)" (click)="toggleEdit(i)">Enable Edit</button>
                                    <button *ngIf="!formControlState(i)" (click)="toggleEdit(i)">Save</button>
                                </div>
                            </div>
                            <button (click)="update_EVENT()">Submit
                                Form</button>
                        </form>
                    </div>
                </mat-expansion-panel>
            </mat-accordion>
        </div>
        <div class="horizontal-order" *ngIf="searchType == 'account'">
            <mat-card-content *ngFor="let customer of customers; let i = index"
                class="user-info-content horizontal-card-content">
                <p class="user-name">
                    ACCOUNTID: {{ customer.nfmAccountId }}
                </p>
                <mat-form-field class="account-id-input" appearance="fill">
                    <mat-label>First Name</mat-label>
                    <input matInput placeholder="Ex. Anderson" [(ngModel)]="customer.firstName"
                        name="addressInputField" />
                </mat-form-field>
                <mat-form-field class="account-id-input" appearance="fill">
                    <mat-label>Middle Name</mat-label>
                    <input matInput placeholder="Ex. Anderson" [(ngModel)]="customer.middleName"
                        name="addressInputField" />
                </mat-form-field>
                <mat-form-field class="account-id-input" appearance="fill">
                    <mat-label>Last Name</mat-label>
                    <input matInput placeholder="Ex. Anderson" [(ngModel)]="customer.lastName"
                        name="addressInputField" />
                </mat-form-field>
                <mat-form-field class="account-id-input" appearance="fill">
                    <mat-label>Address</mat-label>
                    <input matInput placeholder="Ex. 1234 Dodge St." [(ngModel)]="customer.addressLineOneText"
                        name="addressInputField" />
                </mat-form-field>
                <mat-form-field class="account-id-input" appearance="fill">
                    <mat-label>Address 2</mat-label>
                    <input matInput placeholder="Ex. 1234 Dodge St." [(ngModel)]="customer.addressLineTwoText"
                        name="addressInputField" />
                </mat-form-field>
                <mat-form-field class="account-id-input" appearance="fill">
                    <mat-label>City</mat-label>
                    <input matInput placeholder="Ex. Omaha" [(ngModel)]="customer.addressCityName"
                        [value]="customer.addressPostalPlusFourCode" name="cityInputField" />
                </mat-form-field>
                <mat-form-field appearance="fill" class="account-id-input">
                    <mat-label>State</mat-label>
                    <mat-select [(ngModel)]="customer.addressStateProvinceCode" name="stateField">
                        <mat-option *ngFor="let state of allStates" [value]="customer.addressStateProvinceCode">
                            {{ state }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
                <mat-form-field class="account-id-input" appearance="fill">
                    <mat-label>Zip Code</mat-label>
                    <input matInput placeholder="Ex. 68102" [(ngModel)]="customer.addressPostalPlusFourCode"
                        name="zipCodeInputField" />
                </mat-form-field>
                <mat-form-field class="account-id-input" appearance="fill">
                    <mat-label>Country Code</mat-label>
                    <input matInput placeholder="Ex. 68102" [(ngModel)]="customer.addressCountryCode"
                        name="zipCodeInputField" />
                </mat-form-field>
                <mat-form-field class="account-id-input" appearance="fill">
                    <mat-label>Phone Work</mat-label>
                    <input matInput placeholder="Ex. 4025448231" [(ngModel)]="customer.phoneWork"
                        name="phoneInputField" />
                </mat-form-field>
                <mat-form-field class="account-id-input" appearance="fill">
                    <mat-label>Phone Home</mat-label>
                    <input matInput placeholder="Ex. 4025448231" [(ngModel)]="customer.phoneHome"
                        name="phoneInputField" />
                </mat-form-field>
                <!-- <mat-form-field class="account-id-input" appearance="fill">
                                <mat-label>Email ID:</mat-label>
                                <input matInput placeholder="Ex. 68102" [ngModel]="customer.pEmail | pEmailID"
                                    (ngModelChange)="updateEmailValue($event)" name="zipCodeInputField" />
                            </mat-form-field>
                            <mat-form-field class="account-id-input" appearance="fill">
                                <mat-label>Email String</mat-label>
                                <input matInput placeholder="Ex. 68102" [ngModel]="customer.pEmail | pEmailString"
                                    (ngModelChange)="updateEmailValue($event)" name="zipCodeInputField" />
                            </mat-form-field> -->
                <mat-form-field class="account-id-input" appearance="fill"
                    *ngIf="customer.accountPartyType == 'Primary'">
                    <mat-label>Email</mat-label>
                    <input matInput placeholder="Ex. 68102" [ngModel]="customer.pEmail | email"
                        (ngModelChange)="updateEmailValue($event)" name="zipCodeInputField" />
                </mat-form-field>
                <mat-form-field class="account-id-input" appearance="fill" *ngIf="customer.accountPartyType == 'Joint'">
                    <mat-label>Email</mat-label>
                    <input matInput placeholder="Ex. 68102" [ngModel]="customer.jEmail | email"
                        (ngModelChange)="updateEmailValue($event)" name="zipCodeInputField" />
                </mat-form-field>
            </mat-card-content>
        </div>
        <p *ngIf="userNotFound" class="error-message">User not found!</p>
        <mat-card-actions *ngIf="!userNotFound" class="action-button">
            <button (click)="update_EVENT()" mat-raised-button color="primary" disabled>
                UPDATE
            </button>
        </mat-card-actions>
    </div>
</mat-card>